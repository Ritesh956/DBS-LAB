1. Retrieve the birth date and address of 'John B. Smith'.

Ans: 

SELECT BDATE, ADDRESS
FROM EMPLOYEE
WHERE FNAME = 'John' AND MINIT = 'B' AND LNAME = 'Smith';

Retrieve the name and address of employees in 'Research' department

SELECT E.FNAME, E.LNAME, E.ADDRESS
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DNO = D.DNUMBER
WHERE D.DNAME = 'Research';


2. Projects in 'Stanford' with department manager details.

Ans: 

SELECT P.PNUMBER, P.DNUM, M.LNAME, M.ADDRESS, M.BDATE
FROM PROJECT P
JOIN DEPARTMENT D ON P.DNUM = D.DNUMBER
JOIN EMPLOYEE M ON D.MGR_SSN = M.SSN
WHERE P.PLOCATION = 'Stanford';


3. Employees and their supervisors.

Ans: 

SELECT E.FNAME AS EMPLOYEE_FNAME, E.LNAME AS EMPLOYEE_LNAM,
       S.FNAME AS SUPERVISOR_FNAME, S.LNAME AS SUPERVISOR_LNAME
FROM EMPLOYEE E
LEFT JOIN EMPLOYEE S ON E.SUPER_SSN = S.SSN;


4. Project numbers involving 'Smith'.

Ans: 

SELECT DISTINCT W.PNO
FROM WORKS_ON W
JOIN EMPLOYEE E ON W.ESSN = E.SSN
WHERE E.LNAME = 'Smith'
UNION
SELECT DISTINCT P.PNUMBER
FROM PROJECT P
JOIN DEPARTMENT D ON P.DNUM = D.DNUMBER
JOIN EMPLOYEE M ON D.MGR_SSN = M.SSN
WHERE M.LNAME = 'Smith';


5. Salaries with 10% raise for 'ProductX' workers

Ans: 

SELECT E.FNAME, E.LNAME, E.SALARY * 1.1 AS NEW_SALARY
FROM EMPLOYEE E
JOIN WORKS_ON W ON E.SSN = W.ESSN
JOIN PROJECT P ON W.PNO = P.PNUMBER
WHERE P.PNAME = 'ProductX';


6. Employees and projects ordered by department, then name

Ans: 

SELECT E.FNAME, E.LNAME, P.PNAME
FROM EMPLOYEE E
JOIN WORKS_ON W ON E.SSN = W.ESSN
JOIN PROJECT P ON W.PNO = P.PNUMBER
ORDER BY E.DNO, E.LNAME, E.FNAME;


7. Employees with dependents of the same first name and sex

Ans: 

SELECT DISTINCT E.FNAME, E.LNAME
FROM EMPLOYEE E
JOIN DEPENDENT D ON E.SSN = D.ESSN
WHERE E.FNAME = D.DEPENDENT_NAME AND E.SEX = D.SEX;


8. Employees with no dependents

Ans: 

SELECT E.FNAME, E.LNAME
FROM EMPLOYEE E
LEFT JOIN DEPENDENT D ON E.SSN = D.ESSN
WHERE D.ESSN IS NULL;


9. Managers with at least one dependent

Ans: 

SELECT DISTINCT M.FNAME, M.LNAME
FROM EMPLOYEE M
JOIN DEPARTMENT D ON M.SSN = D.MGR_SSN
JOIN DEPENDENT Dep ON M.SSN = DEP.ESSN;


10. Salary statistics

Ans: 

SELECT SUM(SALARY) AS TOTAL_SALARY, MAX(SALARY) AS MAX_SALARY,
       MIN(SALARY) AS MIN_SALARY, AVG(SALARY) AS AVG_SALARY
FROM EMPLOYEE;


11. Project employee counts.

Ans: 

SELECT P.PNUMBER, P.PNAME, COUNT(W.ESSN) AS EMPLOYEE_COUNT
FROM PROJECT P
JOIN WORKS_ON W ON P.PNUMBER = W.PNO
GROUP BY P.PNUMBER, P.PNAME;


12. Projects with more than two employees

Ans: 

SELECT P.PNUMBER, P.PNAME, COUNT(W.ESSN) AS EMPLOYEE_COUNT
FROM PROJECT P
JOIN WORKS_ON W ON P.PNUMBER = W.PNO
GROUP BY P.PNUMBER, P.PNAME
HAVING COUNT(W.ESSN) > 2;


13. Departments with more than five employees earning over 40,000.

Ans: 

SELECT E.DNO, COUNT(E.SSN) AS EMPLOYEE_COUNT
FROM EMPLOYEE E
WHERE E.SALARY > 40000
GROUP BY E.DNO
HAVING COUNT(E.SSN) > 5;